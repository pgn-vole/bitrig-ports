$OpenBSD: patch-src_util_c,v 1.1 2015/03/31 15:36:52 naddy Exp $

CVE-2014-9112: heap overflow in process_copy_in()

--- src/util.c.orig	Wed Mar 10 11:22:30 2010
+++ src/util.c	Sun Mar 29 21:11:01 2015
@@ -206,10 +206,7 @@ tape_fill_input_buffer (int in_des, int num_bytes)
   if (input_size < 0)
     error (1, errno, _("read error"));
   if (input_size == 0)
-    {
-      error (0, 0, _("premature end of file"));
-      exit (1);
-    }
+    error (PAXEXIT_FAILURE, 0, _("premature end of file"));
   input_bytes += input_size;
 }
 
