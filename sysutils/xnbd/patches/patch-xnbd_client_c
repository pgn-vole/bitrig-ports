--- xnbd_client.c.orig	Sun Apr 19 14:21:39 2015
+++ xnbd_client.c	Sun Apr 19 14:20:02 2015
@@ -24,7 +24,9 @@
 #include "xnbd.h"
 #include <sys/ioctl.h>
 #include <sys/reboot.h>
+#ifndef __Bitrig__
 #include <linux/fs.h>           /* for BLKRRPART */
+#endif
 #include <assert.h>
 
 
@@ -450,7 +452,9 @@ static int xnbd_setup_client(const char *devpath, unsi
 		 * re-read partition table.
 		 * this may fail if the kernel does not support it.
 		 **/
+#ifndef __Bitrig__
 		ioctl(nbd, BLKRRPART);
+#endif
 
 		close(sockfd);
 		close(nbd);
