$OpenBSD: patch-salt_modules_network_py,v 1.5 2015/03/27 14:40:04 ajacoutot Exp $

https://github.com/saltstack/salt/commit/294ea72d9419e69f3f613e951a7cfd5f4840c66f

--- salt/modules/network.py.orig	Wed Mar 25 00:26:39 2015
+++ salt/modules/network.py	Fri Mar 27 15:38:04 2015
@@ -419,7 +419,12 @@ def arp():
         comps = line.split()
         if len(comps) < 4:
             continue
-        ret[comps[3]] = comps[1].strip('(').strip(')')
+        if not __grains__['kernel'] == 'OpenBSD':
+           ret[comps[3]] = comps[1].strip('(').strip(')')
+        else:
+           if comps[0] == 'Host' or comps[1] == '(incomplete)':
+               continue
+           ret[comps[1]] = comps[0]
     return ret
 
 
@@ -613,6 +618,9 @@ def mod_hostname(hostname):
                     fh.write(i)
     elif __grains__['os_family'] == 'Debian':
         with salt.utils.fopen('/etc/hostname', 'w') as fh:
+            fh.write(hostname + '\n')
+    elif __grains__['os_family'] == 'OpenBSD':
+        with salt.utils.fopen('/etc/myname', 'w') as fh:
             fh.write(hostname + '\n')
 
     return True
