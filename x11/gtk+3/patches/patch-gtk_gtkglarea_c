$OpenBSD: patch-gtk_gtkglarea_c,v 1.1 2015/03/27 16:00:55 ajacoutot Exp $

From f72db440b564098c7c9297bf1390c136e22b4e68 Mon Sep 17 00:00:00 2001
From: Emmanuele Bassi <ebassi@gnome.org>
Date: Wed, 25 Mar 2015 15:19:30 +0000
Subject: glarea: Check that the context is not NULL

--- gtk/gtkglarea.c.orig	Sun Mar 22 00:53:50 2015
+++ gtk/gtkglarea.c	Fri Mar 27 14:28:34 2015
@@ -448,6 +448,11 @@ gtk_gl_area_attach_buffers (GtkGLArea *area)
 {
   GtkGLAreaPrivate *priv = gtk_gl_area_get_instance_private (area);
 
+  g_return_if_fail (GTK_IS_GL_AREA (area));
+
+  if (priv->context == NULL)
+    return;
+
   gtk_gl_area_make_current (area);
 
   if (!priv->have_buffers)
@@ -631,6 +636,9 @@ gtk_gl_area_draw (GtkWidget *widget,
       return FALSE;
     }
 
+  if (priv->context == NULL)
+    return FALSE;
+
   gtk_gl_area_make_current (area);
 
   gtk_gl_area_attach_buffers (area);
@@ -1301,6 +1309,6 @@ gtk_gl_area_make_current (GtkGLArea *area)
 
   g_return_if_fail (gtk_widget_get_realized (widget));
 
-  if (priv->context)
+  if (priv->context != NULL)
     gdk_gl_context_make_current (priv->context);
 }
